2025-07-21 22:04:09,049 - __main__ - INFO - Logging initialized. Log file: ./logs/training_20250721_220409.log
2025-07-21 22:04:09,049 - __main__ - INFO - Starting CCMT training
2025-07-21 22:04:09,050 - __main__ - INFO - Configuration: {'model': {'audio_model_id': 'facebook/wav2vec2-base-960h', 'english_model_name': 'bert-base-uncased', 'vietnamese_model_name': 'vinai/phobert-base-v2', 'common_dim': 512, 'num_tokens_per_modality': 100, 'ccmt_depth': 6, 'ccmt_heads': 8, 'ccmt_mlp_dim': 1024, 'num_score_bins': 21, 'dropout': 0.2}, 'data': {'max_text_length': 512, 'num_audio_chunks': 10, 'chunk_length_sec': 30, 'sample_rate': 16000, 'remove_low_content': True, 'filter_scores': True, 'use_audio_augmentation': True, 'noise_prob': 0.7, 'speed_prob': 0.7, 'pitch_prob': 0.7, 'asr_model_name': 'openai/whisper-base', 'translation_model_name': 'Helsinki-NLP/opus-mt-en-vi'}, 'training': {'batch_size': 1, 'epochs': 25, 'device': 'cuda', 'learning_rates': {'base': 2e-05, 'encoder': 1e-06, 'scale': 0.001}, 'optimizer_name': 'adamw', 'weight_decay': 0.0001, 'scheduler_name': 'cosine', 'warmup_steps': 500, 'lambda_kl': 0.9, 'lambda_mse': 0.1, 'soft_target_std': 0.3, 'sampling_strategy': 'inverse_score', 'sampling_alpha': 0.5, 'class_weight_beta': 0.99, 'use_selective_freezing': True, 'freezing_stopword_ratio': 0.05, 'patience': 5, 'min_delta': 0.0001}, 'logging': {'log_level': 'INFO', 'log_dir': './logs', 'save_dir': './checkpoints', 'use_wandb': True, 'wandb_project': 'esl-ccmt-grading', 'wandb_entity': None, 'wandb_run_name': None, 'save_best_only': True, 'save_every_n_epochs': 5, 'test_output_dir': './results'}, 'paths': {'train_path': '/media/gpus/Data/AES/ESL-Grading/data/train_pro.csv', 'val_path': '/media/gpus/Data/AES/ESL-Grading/data/val_pro.csv', 'test_path': '/media/gpus/Data/AES/ESL-Grading/data/test_pro.csv'}}
2025-07-21 22:04:09,072 - __main__ - INFO - Using device: cuda
2025-07-21 22:04:09,090 - __main__ - INFO - CUDA device: NVIDIA GeForce RTX 2080 Ti
2025-07-21 22:04:09,091 - __main__ - INFO - CUDA memory: 11.5 GB
2025-07-21 22:04:09,091 - __main__ - INFO - Creating CCMT model...
2025-07-21 22:05:31,433 - __main__ - INFO - Model created with 365,554,602 total parameters
2025-07-21 22:05:31,433 - __main__ - INFO - Trainable parameters: 365,554,602
2025-07-21 22:05:31,434 - __main__ - INFO - Creating text processor...
2025-07-21 22:05:34,971 - __main__ - INFO - Text processor created successfully
2025-07-21 22:05:34,972 - __main__ - INFO - Creating trainer...
2025-07-21 22:05:35,804 - __main__ - INFO - Preparing datasets...
2025-07-21 22:05:35,896 - __main__ - INFO - Data sizes - Train: 5879, Val: 840, Test: 1680
2025-07-21 22:06:25,626 - __main__ - INFO - Dataset sizes after filtering - Train: 5600, Val: 797, Test: 1592
2025-07-21 22:06:25,765 - __main__ - INFO - Class weights calculated: tensor([2.7215, 2.7215, 2.7215, 2.7215, 2.7215, 2.7215, 0.1500, 0.1744, 0.1037,
        0.1659, 0.1023, 0.1727, 0.1021, 0.1800, 0.1247, 0.2380, 0.1652, 0.2744,
        0.3789, 0.9711, 1.3676], device='cuda:0')
2025-07-21 22:06:26,020 - __main__ - INFO - Training setup complete. Total steps: 140000
2025-07-21 22:06:26,020 - __main__ - INFO - Starting training...
2025-07-21 22:06:26,021 - __main__ - INFO - Starting training...
2025-07-21 22:06:28,472 - __main__ - INFO - Selective freezing applied to embedding layers
